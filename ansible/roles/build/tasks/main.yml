---
# tasks file for build
- name: Clone simple-springboot-project from github
  git:
    repo: https://github.com/AlexanderKazakov1/simple-springboot-project.git
    dest: /home/user/app

- name: Checkout to develop
  shell: cd /home/user/app && git checkout feature/ansible

- name: Ensure service is enabled
  command: service docker restart

- name: Build simple-springboot-project
  docker_image:
    name: simple-springboot-project-image
    build:
      path: /home/user/app
      dockerfile: Dockerfile
    source: build

- name: Tag simple-springboot-project and push to docker hub
  docker_image:
    name: simple-springboot-project-image
    repository: a1kazakov/simple-springboot-project-image
    push: yes
    source: local